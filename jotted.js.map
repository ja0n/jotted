{"version":3,"file":null,"sources":["/home/ja0n/Projects/jotted/src/util.js","/home/ja0n/Projects/jotted/src/template.js","/home/ja0n/Projects/jotted/src/plugin.js","/home/ja0n/Projects/jotted/src/pubsoup.js","/home/ja0n/Projects/jotted/src/plugins/render.js","/home/ja0n/Projects/jotted/src/plugins/scriptless.js","/home/ja0n/Projects/jotted/src/plugins/ace.js","/home/ja0n/Projects/jotted/src/plugins/codemirror.js","/home/ja0n/Projects/jotted/src/plugins/less.js","/home/ja0n/Projects/jotted/src/plugins/coffeescript.js","/home/ja0n/Projects/jotted/src/plugins/stylus.js","/home/ja0n/Projects/jotted/src/plugins/babel.js","/home/ja0n/Projects/jotted/src/plugins/markdown.js","/home/ja0n/Projects/jotted/src/plugins/console.js","/home/ja0n/Projects/jotted/src/plugins/play.js","/home/ja0n/Projects/jotted/src/plugins/pen.js","/home/ja0n/Projects/jotted/src/bundle-plugins.js","/home/ja0n/Projects/jotted/src/core.js"],"sourcesContent":["/* util\n */\n\nfunction extend (obj = {}, defaults = {}) {\n  var extended = {}\n  // clone object\n  Object.keys(obj).forEach(function (key) {\n    extended[key] = obj[key]\n  })\n\n  // copy default keys where undefined\n  Object.keys(defaults).forEach(function (key) {\n    if (typeof extended[key] !== 'undefined') {\n      extended[key] = obj[key]\n    } else {\n      extended[key] = defaults[key]\n    }\n  })\n\n  return extended\n}\n\nfunction fetch (url, callback) {\n  var xhr = new window.XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'text'\n\n  xhr.onload = function () {\n    if (xhr.status === 200) {\n      callback(null, xhr.responseText)\n    } else {\n      callback(url, xhr)\n    }\n  }\n\n  xhr.onerror = function (err) {\n    callback(err)\n  }\n\n  xhr.send()\n}\n\nfunction runCallback (index, params, arr, errors, callback) {\n  return function (err, res) {\n    if (err) {\n      errors.push(err)\n    }\n\n    index++\n    if (index < arr.length) {\n      seqRunner(index, res, arr, errors, callback)\n    } else {\n      callback(errors, res)\n    }\n  }\n}\n\nfunction seqRunner (index, params, arr, errors, callback) {\n  // async\n  arr[index](params, runCallback.apply(this, arguments))\n}\n\nfunction seq (arr, params, callback = function () {}) {\n  var errors = []\n\n  if (!arr.length) {\n    return callback(errors, params)\n  }\n\n  seqRunner(0, params, arr, errors, callback)\n}\n\nfunction debounce (fn, delay) {\n  var cooldown = null\n  var multiple = null\n  return function () {\n    if (cooldown) {\n      multiple = true\n    } else {\n      fn.apply(this, arguments)\n    }\n\n    clearTimeout(cooldown)\n\n    cooldown = setTimeout(() => {\n      if (multiple) {\n        fn.apply(this, arguments)\n      }\n\n      cooldown = null\n      multiple = null\n    }, delay)\n  }\n}\n\nfunction log () {\n  console.log(arguments)\n}\n\nfunction hasClass (node, className) {\n  if (!node.className) {\n    return false\n  }\n  var tempClass = ' ' + node.className + ' '\n  className = ' ' + className + ' '\n\n  if (tempClass.indexOf(className) !== -1) {\n    return true\n  }\n\n  return false\n}\n\nfunction addClass (node, className) {\n  // class is already added\n  if (hasClass(node, className)) {\n    return node.className\n  }\n\n  if (node.className) {\n    className = ' ' + className\n  }\n\n  node.className += className\n\n  return node.className\n}\n\nfunction removeClass (node, className) {\n  var spaceBefore = ' ' + className\n  var spaceAfter = className + ' '\n\n  if (node.className.indexOf(spaceBefore) !== -1) {\n    node.className = node.className.replace(spaceBefore, '')\n  } else if (node.className.indexOf(spaceAfter) !== -1) {\n    node.className = node.className.replace(spaceAfter, '')\n  } else {\n    node.className = node.className.replace(className, '')\n  }\n\n  return node.className\n}\n\nfunction data (node, attr) {\n  return node.getAttribute('data-' + attr)\n}\n\n// mode detection based on content type and file extension\nvar defaultModemap = {\n  'html': 'html',\n  'css': 'css',\n  'js': 'javascript',\n  'less': 'less',\n  'styl': 'stylus',\n  'coffee': 'coffeescript'\n}\n\nfunction getMode (type = '', file = '', customModemap = {}) {\n  var modemap = extend(customModemap, defaultModemap)\n\n  // try the file extension\n  for (let key in modemap) {\n    let keyLength = key.length\n    if (file.slice(-keyLength++) === '.' + key) {\n      return modemap[key]\n    }\n  }\n\n  // try the file type (html/css/js)\n  for (let key in modemap) {\n    if (type === key) {\n      return modemap[key]\n    }\n  }\n\n  return type\n}\n\nexport {\n  extend,\n  fetch,\n  seq,\n  debounce,\n  log,\n  getMode,\n\n  data,\n  hasClass,\n  addClass,\n  removeClass\n}\n","/* template\n */\n\nexport function container () {\n  return `\n    <ul class=\"jotted-nav\">\n      <li class=\"jotted-nav-item jotted-nav-item-result\">\n        <a href=\"#\" data-jotted-type=\"result\">\n          Result\n        </a>\n      </li>\n      <li class=\"jotted-nav-item jotted-nav-item-html\">\n        <a href=\"#\" data-jotted-type=\"html\">\n          HTML\n        </a>\n      </li>\n      <li class=\"jotted-nav-item jotted-nav-item-css\">\n        <a href=\"#\" data-jotted-type=\"css\">\n          CSS\n        </a>\n      </li>\n      <li class=\"jotted-nav-item jotted-nav-item-js\">\n        <a href=\"#\" data-jotted-type=\"js\">\n          JavaScript\n        </a>\n      </li>\n    </ul>\n    <div class=\"jotted-pane jotted-pane-result\"><iframe></iframe></div>\n    <div class=\"jotted-pane jotted-pane-html\"></div>\n    <div class=\"jotted-pane jotted-pane-css\"></div>\n    <div class=\"jotted-pane jotted-pane-js\"></div>\n  `\n}\n\nexport function paneActiveClass (type) {\n  return `jotted-pane-active-${type}`\n}\n\nexport function containerClass () {\n  return `jotted`\n}\n\nexport function hasFileClass (type) {\n  return `jotted-has-${type}`\n}\n\nexport function hideResultClass () {\n  return `jotted-hide-result`\n}\n\nexport function editorClass (type) {\n  return `jotted-editor jotted-editor-${type}`\n}\n\nexport function editorContent (type, fileUrl = '') {\n  return `\n    <textarea data-jotted-type=\"${type}\" data-jotted-file=\"${fileUrl}\"></textarea>\n    <div class=\"jotted-status\"></div>\n  `\n}\n\nexport function statusMessage (err) {\n  return `\n    <p>${err}</p>\n  `\n}\n\nexport function statusClass (type) {\n  return `jotted-status-${type}`\n}\n\nexport function statusActiveClass (type) {\n  return `jotted-status-active-${type}`\n}\n\nexport function pluginClass (name) {\n  return `jotted-plugin-${name}`\n}\n\nexport function statusLoading (url) {\n  return `Loading <strong>${url}</strong>..`\n}\n\nexport function statusFetchError (url) {\n  return `There was an error loading <strong>${url}</strong>.`\n}\n","/* plugin\n */\n\nimport * as util from './util.js'\nimport * as template from './template.js'\n\nvar plugins = []\n\nfunction find (id) {\n  for (let pluginIndex in plugins) {\n    let plugin = plugins[pluginIndex]\n    if (plugin._id === id) {\n      return plugin\n    }\n  }\n\n  // can't find plugin\n  throw new Error(`Plugin ${id} is not registered.`)\n}\n\nfunction register (id, plugin) {\n  // private properties\n  plugin._id = id\n  plugins.push(plugin)\n}\n\n// create a new instance of each plugin, on the jotted instance\nfunction init () {\n  this._get('options').plugins.forEach((plugin) => {\n    // check if plugin definition is string or object\n    let Plugin\n    let pluginName\n    let pluginOptions = {}\n    if (typeof plugin === 'string') {\n      pluginName = plugin\n    } else if (typeof plugin === 'object') {\n      pluginName = plugin.name\n      pluginOptions = plugin.options || {}\n    }\n\n    Plugin = find(pluginName)\n    this._get('plugins')[pluginName] = new Plugin(this, pluginOptions)\n\n    util.addClass(this._get('$container'), template.pluginClass(pluginName))\n  })\n}\n\nexport {\n  register,\n  init\n}\n","/* pubsoup\n */\n\nimport * as util from './util.js'\n\nexport default class PubSoup {\n  constructor () {\n    this.topics = {}\n    this.callbacks = {}\n  }\n\n  find (query) {\n    this.topics[query] = this.topics[query] || []\n    return this.topics[query]\n  }\n\n  subscribe (topic, subscriber, priority = 90) {\n    var foundTopic = this.find(topic)\n    subscriber._priority = priority\n    foundTopic.push(subscriber)\n\n    // sort subscribers on priority\n    foundTopic.sort(function (a, b) {\n      return (a._priority > b._priority) ? 1 : ((b._priority > a._priority) ? -1 : 0)\n    })\n  }\n\n  subscribeOnce (topic, subscriber, priority = 90) {\n    const pack = () => {\n      subscriber(arguments)\n      this.unsubscribe(topic, pack)\n    }\n\n    this.subscribe(topic, pack, priority)\n  }\n\n  // removes a function from an array\n  remover (arr, fn) {\n    arr.forEach(function () {\n      // if no fn is specified\n      // clean-up the array\n      if (!fn) {\n        arr.length = 0\n        return\n      }\n\n      // find the fn in the arr\n      var index = [].indexOf.call(arr, fn)\n\n      // we didn't find it in the array\n      if (index === -1) {\n        return\n      }\n\n      arr.splice(index, 1)\n    })\n  }\n\n  unsubscribe (topic, subscriber) {\n    // remove from subscribers\n    var foundTopic = this.find(topic)\n    this.remover(foundTopic, subscriber)\n\n    // remove from callbacks\n    this.callbacks[topic] = this.callbacks[topic] || []\n    this.remover(this.callbacks[topic], subscriber)\n  }\n\n  unsubscribeAll () {\n    Object.keys(this.topics).forEach(\n      topic => this.unsubscribe(topic)\n    )\n  }\n\n  // sequentially runs a method on all plugins\n  publish (topic, params = {}) {\n    var foundTopic = this.find(topic)\n    var runList = []\n\n    foundTopic.forEach(function (subscriber) {\n      runList.push(subscriber)\n    })\n\n    util.seq(runList, params, this.runCallbacks(topic))\n  }\n\n  // parallel run all .done callbacks\n  runCallbacks (topic) {\n    return (err, params) => {\n      this.callbacks[topic] = this.callbacks[topic] || []\n\n      this.callbacks[topic].forEach((c) => {\n        c(err, params)\n      })\n    }\n  }\n\n  // attach a callback when a publish[topic] is done\n  done (topic, callback = function () {}) {\n    this.callbacks[topic] = this.callbacks[topic] || []\n    this.callbacks[topic].push(callback)\n  }\n}\n","/* render plugin\n * renders the iframe\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginRender {\n  constructor (jotted, options) {\n    options = util.extend(options, {})\n\n    // iframe srcdoc support\n    var supportSrcdoc = !!('srcdoc' in document.createElement('iframe'))\n    var $resultFrame = jotted.$container.querySelector('.jotted-pane-result iframe')\n\n    var frameContent = ''\n\n    // cached content\n    var content = {\n      html: '',\n      css: '',\n      js: ''\n    }\n\n    // public\n    this.jotted = jotted\n    this.supportSrcdoc = supportSrcdoc\n    this.content = content\n    this.frameContent = frameContent\n    this.$resultFrame = $resultFrame\n    this.onMessage = e => this.domready(e)\n\n    this.callbacks = []\n    this.index = 0\n\n    this.lastCallback = () => {}\n\n    // catch domready events from the iframe\n    window.addEventListener('message', this.onMessage)\n\n    // render on each change\n    jotted.on('change', this.change.bind(this), 100)\n  }\n\n  destroy () {\n    window.removeEventListener('message', this.onMessage)\n  }\n\n  template (style = '', body = '', script = '') {\n    return `\n      <!doctype html>\n      <html>\n        <head>\n          <script>\n            (function () {\n              window.addEventListener('DOMContentLoaded', function () {\n                window.parent.postMessage(JSON.stringify({\n                  type: 'jotted-dom-ready'\n                }), '*')\n              })\n            }())\n          </script>\n\n          <style>${style}</style>\n        </head>\n        <body>\n          ${body}\n\n          <!--\n            Jotted:\n            Empty script tag prevents malformed HTML from breaking the next script.\n          -->\n          <script></script>\n          <script>${script}</script>\n        </body>\n      </html>\n    `\n  }\n\n  change (params, callback) {\n    // cache manipulated content\n    this.content[params.type] = params.content\n\n    // check existing and to-be-rendered content\n    var oldFrameContent = this.frameContent\n    this.frameContent = this.template(this.content['css'], this.content['html'], this.content['js'])\n\n    // cache the current callback as global,\n    // so we can call it from the message callback.\n    this.lastCallback = () => {\n      this.lastCallback = () => {}\n\n      callback(null, params)\n    }\n\n    // don't render if previous and new frame content are the same.\n    // mostly for the `play` plugin,\n    // so we don't re-render the same content on each change.\n    // unless we set forceRender.\n    if (params.forceRender !== true && this.frameContent === oldFrameContent) {\n      callback(null, params)\n      return\n    }\n\n    if (this.supportSrcdoc) {\n      // srcdoc in unreliable in Chrome.\n      // https://github.com/ghinda/jotted/issues/23\n\n      // re-create the iframe on each change,\n      // to discard the previously loaded scripts.\n      var $newResultFrame = document.createElement('iframe')\n      this.$resultFrame.parentNode.replaceChild($newResultFrame, this.$resultFrame)\n      this.$resultFrame = $newResultFrame\n\n      this.$resultFrame.contentWindow.document.open()\n      this.$resultFrame.contentWindow.document.write(this.frameContent)\n      this.$resultFrame.contentWindow.document.close()\n    } else {\n      // older browsers without iframe srcset support (IE9).\n      this.$resultFrame.setAttribute('data-srcdoc', this.frameContent)\n\n      // tips from https://github.com/jugglinmike/srcdoc-polyfill\n      // Copyright (c) 2012 Mike Pennisi\n      // Licensed under the MIT license.\n      var jsUrl = 'javascript:window.frameElement.getAttribute(\"data-srcdoc\");'\n\n      this.$resultFrame.setAttribute('src', jsUrl)\n\n      // Explicitly set the iFrame's window.location for\n      // compatibility with IE9, which does not react to changes in\n      // the `src` attribute when it is a `javascript:` URL.\n      if (this.$resultFrame.contentWindow) {\n        this.$resultFrame.contentWindow.location = jsUrl\n      }\n    }\n\n    this.jotted.trigger('render', this.frameContent)\n  }\n\n  domready (e) {\n    // only catch messages from the iframe\n    if (e.source !== this.$resultFrame.contentWindow) {\n      return\n    }\n\n    var data = {}\n    try {\n      data = JSON.parse(e.data)\n    } catch (e) {}\n\n    if (data.type === 'jotted-dom-ready') {\n      this.lastCallback()\n    }\n  }\n}\n","/* scriptless plugin\n * removes script tags from html content\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginScriptless {\n  constructor (jotted, options) {\n    options = util.extend(options, {})\n\n    // https://html.spec.whatwg.org/multipage/scripting.html\n    var runScriptTypes = [\n      'application/javascript',\n      'application/ecmascript',\n      'application/x-ecmascript',\n      'application/x-javascript',\n      'text/ecmascript',\n      'text/javascript',\n      'text/javascript1.0',\n      'text/javascript1.1',\n      'text/javascript1.2',\n      'text/javascript1.3',\n      'text/javascript1.4',\n      'text/javascript1.5',\n      'text/jscript',\n      'text/livescript',\n      'text/x-ecmascript',\n      'text/x-javascript'\n    ]\n\n    // remove script tags on each change\n    jotted.on('change', this.change.bind(this))\n\n    // public\n    this.runScriptTypes = runScriptTypes\n  }\n\n  change (params, callback) {\n    if (params.type !== 'html') {\n      return callback(null, params)\n    }\n\n    // for IE9 support, remove the script tags from HTML content.\n    // when we stop supporting IE9, we can use the sandbox attribute.\n    var fragment = document.createElement('div')\n    fragment.innerHTML = params.content\n\n    var typeAttr = null\n\n    // remove all script tags\n    var $scripts = fragment.querySelectorAll('script')\n    for (let i = 0; i < $scripts.length; i++) {\n      typeAttr = $scripts[i].getAttribute('type')\n\n      // only remove script tags without the type attribute\n      // or with a javascript mime attribute value.\n      // the ones that are run by the browser.\n      if (!typeAttr || this.runScriptTypes.indexOf(typeAttr) !== -1) {\n        $scripts[i].parentNode.removeChild($scripts[i])\n      }\n    }\n\n    params.content = fragment.innerHTML\n\n    callback(null, params)\n  }\n}\n","/* ace plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginAce {\n  constructor (jotted, options) {\n    var priority = 1\n    var i\n\n    this.editor = {}\n    this.jotted = jotted\n\n    options = util.extend(options, {})\n\n    // check if Ace is loaded\n    if (typeof window.ace === 'undefined') {\n      return\n    }\n\n    var $editors = jotted.$container.querySelectorAll('.jotted-editor')\n\n    for (i = 0; i < $editors.length; i++) {\n      let $textarea = $editors[i].querySelector('textarea')\n      let type = util.data($textarea, 'jotted-type')\n      let file = util.data($textarea, 'jotted-file')\n\n      let $aceContainer = document.createElement('div')\n      $editors[i].appendChild($aceContainer)\n\n      this.editor[type] = window.ace.edit($aceContainer)\n      let editor = this.editor[type]\n\n      let editorOptions = util.extend(options)\n\n      editor.getSession().setMode('ace/mode/' + util.getMode(type, file))\n      editor.getSession().setOptions(editorOptions)\n\n      editor.$blockScrolling = Infinity\n    }\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  editorChange (params) {\n    return () => {\n      this.jotted.trigger('change', params)\n    }\n  }\n\n  change (params, callback) {\n    var editor = this.editor[params.type]\n\n    // if the event is not started by the ace change.\n    // triggered only once per editor,\n    // when the textarea is populated/file is loaded.\n    if (!params.aceEditor) {\n      editor.getSession().setValue(params.content)\n\n      // attach the event only after the file is loaded\n      params.aceEditor = editor\n      editor.on('change', this.editorChange(params))\n    }\n\n    // manipulate the params and pass them on\n    params.content = editor.getValue()\n    callback(null, params)\n  }\n}\n","/* coremirror plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginCodeMirror {\n  constructor (jotted, options) {\n    var priority = 1\n    var i\n\n    this.editor = {}\n    this.jotted = jotted\n\n    // custom modemap for codemirror\n    var modemap = {\n      'html': 'htmlmixed'\n    }\n\n    options = util.extend(options, {\n      lineNumbers: true\n    })\n\n    // check if CodeMirror is loaded\n    if (typeof window.CodeMirror === 'undefined') {\n      return\n    }\n\n    var $editors = jotted.$container.querySelectorAll('.jotted-editor')\n\n    for (i = 0; i < $editors.length; i++) {\n      let $textarea = $editors[i].querySelector('textarea')\n      let type = util.data($textarea, 'jotted-type')\n      let file = util.data($textarea, 'jotted-file')\n\n      this.editor[type] = window.CodeMirror.fromTextArea($textarea, options)\n      this.editor[type].setOption('mode', util.getMode(type, file, modemap))\n    }\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  editorChange (params) {\n    return () => {\n      // trigger a change event\n      this.jotted.trigger('change', params)\n    }\n  }\n\n  change (params, callback) {\n    var editor = this.editor[params.type]\n\n    // if the event is not started by the codemirror change.\n    // triggered only once per editor,\n    // when the textarea is populated/file is loaded.\n    if (!params.cmEditor) {\n      editor.setValue(params.content)\n\n      // attach the event only after the file is loaded\n      params.cmEditor = editor\n      editor.on('change', this.editorChange(params))\n    }\n\n    // manipulate the params and pass them on\n    params.content = editor.getValue()\n    callback(null, params)\n  }\n}\n","/* less plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginLess {\n  constructor (jotted, options) {\n    var priority = 20\n\n    options = util.extend(options, {})\n\n    // check if less is loaded\n    if (typeof window.less === 'undefined') {\n      return\n    }\n\n    // change CSS link label to Less\n    jotted.$container.querySelector('a[data-jotted-type=\"css\"]').innerHTML = 'Less'\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  isLess (params) {\n    if (params.type !== 'css') {\n      return false\n    }\n\n    return (params.file.indexOf('.less') !== -1 || params.file === '')\n  }\n\n  change (params, callback) {\n    // only parse .less and blank files\n    if (this.isLess(params)) {\n      window.less.render(params.content, this.options, (err, res) => {\n        if (err) {\n          return callback(err, params)\n        } else {\n          // replace the content with the parsed less\n          params.content = res.css\n        }\n\n        callback(null, params)\n      })\n    } else {\n      // make sure we callback either way,\n      // to not break the pubsoup\n      callback(null, params)\n    }\n  }\n}\n","/* coffeescript plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginCoffeeScript {\n  constructor (jotted, options) {\n    var priority = 20\n\n    options = util.extend(options, {})\n\n    // check if coffeescript is loaded\n    if (typeof window.CoffeeScript === 'undefined') {\n      return\n    }\n\n    // change JS link label to Less\n    jotted.$container.querySelector('a[data-jotted-type=\"js\"]').innerHTML = 'CoffeeScript'\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  isCoffee (params) {\n    if (params.type !== 'js') {\n      return false\n    }\n\n    return (params.file.indexOf('.coffee') !== -1 || params.file === '')\n  }\n\n  change (params, callback) {\n    // only parse .less and blank files\n    if (this.isCoffee(params)) {\n      try {\n        params.content = window.CoffeeScript.compile(params.content)\n      } catch (err) {\n        return callback(err, params)\n      }\n    }\n\n    callback(null, params)\n  }\n}\n","/* stylus plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginStylus {\n  constructor (jotted, options) {\n    var priority = 20\n\n    options = util.extend(options, {})\n\n    // check if stylus is loaded\n    if (typeof window.stylus === 'undefined') {\n      return\n    }\n\n    // change CSS link label to Stylus\n    jotted.$container.querySelector('a[data-jotted-type=\"css\"]').innerHTML = 'Stylus'\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  isStylus (params) {\n    if (params.type !== 'css') {\n      return false\n    }\n\n    return (params.file.indexOf('.styl') !== -1 || params.file === '')\n  }\n\n  change (params, callback) {\n    // only parse .styl and blank files\n    if (this.isStylus(params)) {\n      window.stylus(params.content, this.options).render((err, res) => {\n        if (err) {\n          return callback(err, params)\n        } else {\n          // replace the content with the parsed less\n          params.content = res\n        }\n\n        callback(null, params)\n      })\n    } else {\n      // make sure we callback either way,\n      // to not break the pubsoup\n      callback(null, params)\n    }\n  }\n}\n","/* babel plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginBabel {\n  constructor (jotted, options) {\n    var priority = 20\n\n    this.options = util.extend(options, {})\n\n    // check if babel is loaded\n    if (typeof window.Babel !== 'undefined') {\n      // using babel-standalone\n      this.babel = window.Babel\n    } else if (typeof window.babel !== 'undefined') {\n      // using browser.js from babel-core 5.x\n      this.babel = {\n        transform: window.babel\n      }\n    } else {\n      return\n    }\n\n    // change js link label\n    jotted.$container.querySelector('a[data-jotted-type=\"js\"]').innerHTML = 'ES2015'\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  change (params, callback) {\n    // only parse js content\n    if (params.type === 'js') {\n      try {\n        params.content = this.babel.transform(params.content, this.options).code\n      } catch (err) {\n        return callback(err, params)\n      }\n\n      callback(null, params)\n    } else {\n      // make sure we callback either way,\n      // to not break the pubsoup\n      callback(null, params)\n    }\n  }\n}\n","/* markdown plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginMarkdown {\n  constructor (jotted, options) {\n    var priority = 20\n\n    this.options = util.extend(options, {})\n\n    // check if marked is loaded\n    if (typeof window.marked === 'undefined') {\n      return\n    }\n\n    window.marked.setOptions(options)\n\n    // change html link label\n    jotted.$container.querySelector('a[data-jotted-type=\"html\"]').innerHTML = 'Markdown'\n\n    jotted.on('change', this.change.bind(this), priority)\n  }\n\n  change (params, callback) {\n    // only parse html content\n    if (params.type === 'html') {\n      try {\n        params.content = window.marked(params.content)\n      } catch (err) {\n        return callback(err, params)\n      }\n\n      callback(null, params)\n    } else {\n      // make sure we callback either way,\n      // to not break the pubsoup\n      callback(null, params)\n    }\n  }\n}\n","/* console plugin\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginConsole {\n  constructor (jotted, options) {\n    options = util.extend(options, {\n      tabName: 'JS Console',\n      autoClear: false,\n      clearText: 'Clear',\n      aliases: null\n    })\n    var aliases = options.aliases ? `${options.aliases.join(' = ')} = window.console.log;` : ''\n    var priority = 30\n    var history = []\n    var historyIndex = 0\n    var logCaptureSnippet = `(${this.capture.toString()})(); ${aliases}`\n    var contentCache = {\n      html: '',\n      css: '',\n      js: ''\n    }\n\n    // new tab and pane markup\n    var $nav = document.createElement('li')\n    util.addClass($nav, 'jotted-nav-item jotted-nav-item-console')\n    $nav.innerHTML = `<a href=\"#\" data-jotted-type=\"console\">${options.tabName}</a>`\n\n    var $pane = document.createElement('div')\n    util.addClass($pane, 'jotted-pane jotted-pane-console')\n\n    $pane.innerHTML = `\n      <div class=\"jotted-console-container\">\n        <ul class=\"jotted-console-output\"></ul>\n        <form class=\"jotted-console-input\">\n          <input type=\"text\">\n        </form>\n      </div>\n      <button class=\"jotted-button jotted-console-clear\">${options.clearText}</button>\n    `\n\n    jotted.$container.appendChild($pane)\n    jotted.$container.querySelector('.jotted-nav').appendChild($nav)\n\n    var $container = jotted.$container.querySelector('.jotted-console-container')\n    var $output = jotted.$container.querySelector('.jotted-console-output')\n    var $input = jotted.$container.querySelector('.jotted-console-input input')\n    var $inputForm = jotted.$container.querySelector('.jotted-console-input')\n    var $clear = jotted.$container.querySelector('.jotted-console-clear')\n\n    // submit the input form\n    $inputForm.addEventListener('submit', this.submit.bind(this))\n\n    // console history\n    $input.addEventListener('keydown', this.history.bind(this))\n\n    // clear button\n    $clear.addEventListener('click', this.clear.bind(this))\n\n    // clear the console on each change\n    if (options.autoClear === true) {\n      jotted.on('change', this.autoClear.bind(this), priority - 1)\n    }\n\n    // capture the console on each change\n    jotted.on('change', this.change.bind(this), priority)\n\n    if (options.onChange) {\n      // pass colleted console messages to onChange callback\n      jotted.done('change', () => {\n        if (!this.lastPool) {\n          this.lastPool = this.pool\n          return\n        }\n\n        this.lastPool = this.pool\n        this.pool = []\n        options.onChange(this.lastPool)\n      })\n    }\n\n    // plugin public properties\n    this.$jottedContainer = jotted.$container\n    this.$container = $container\n    this.$input = $input\n    this.$output = $output\n    this.history = history\n    this.historyIndex = historyIndex\n    this.logCaptureSnippet = logCaptureSnippet\n    this.contentCache = contentCache\n    this.pool = []\n    this.lastPool = null\n    this.getIframe = this.getIframe.bind(this)\n    this.onMessage = e => this.getMessage(e)\n\n    // get log events from the iframe\n    window.addEventListener('message', this.onMessage)\n  }\n\n  destroy () {\n    window.removeEventListener('message', this.onMessage)\n  }\n\n  getIframe () {\n    return this.$jottedContainer.querySelector('.jotted-pane-result iframe')\n  }\n\n  getMessage (e) {\n    // only catch messages from the iframe\n    if (e.source !== this.getIframe().contentWindow) {\n      return\n    }\n\n    var data = {}\n    try {\n      data = JSON.parse(e.data)\n    } catch (err) {}\n\n    if (data.type === 'jotted-console-log') {\n      this.log(data.message)\n      this.pool.push(data.message)\n    }\n  }\n\n  autoClear (params, callback) {\n    var snippetlessContent = params.content\n\n    // remove the snippet from cached js content\n    if (params.type === 'js') {\n      snippetlessContent = snippetlessContent.replace(this.logCaptureSnippet, '')\n    }\n\n    // for compatibility with the Play plugin,\n    // clear the console only if something has changed or force rendering.\n    if (params.forceRender === true || this.contentCache[params.type] !== snippetlessContent) {\n      this.clear()\n    }\n\n    // always cache the latest content\n    this.contentCache[params.type] = snippetlessContent\n\n    callback(null, params)\n  }\n\n  change (params, callback) {\n    // only parse js content\n    if (params.type !== 'js') {\n      // make sure we callback either way,\n      // to not break the pubsoup\n      return callback(null, params)\n    }\n\n    // check if the snippet is already added.\n    // the Play plugin caches the changed params and triggers change\n    // with the cached response, causing the snippet to be inserted\n    // multiple times, on each trigger.\n    if (params.content.indexOf(this.logCaptureSnippet) === -1) {\n      params.content = `${this.logCaptureSnippet}${params.content}`\n    }\n\n    callback(null, params)\n  }\n\n  // capture the console.log output\n  capture () {\n    // IE9 with devtools closed\n    if (typeof window.console === 'undefined' || typeof window.console.log === 'undefined') {\n      window.console = {\n        log: function () {}\n      }\n    }\n\n    // for IE9 support\n    var oldConsoleLog = Function.prototype.bind.call(window.console.log, window.console)\n\n    window.console.log = function () {\n      // send log messages to the parent window\n      [].slice.call(arguments).forEach(function (message) {\n        window.parent.postMessage(JSON.stringify({\n          type: 'jotted-console-log',\n          message: message\n        }), '*')\n      })\n\n      // in IE9, console.log is object instead of function\n      // https://connect.microsoft.com/IE/feedback/details/585896/console-log-typeof-is-object-instead-of-function\n      oldConsoleLog.apply(oldConsoleLog, arguments)\n    }\n  }\n\n  log (message = '', type) {\n    var $log = document.createElement('li')\n    util.addClass($log, 'jotted-console-log')\n\n    if (typeof type !== 'undefined') {\n      util.addClass($log, `jotted-console-log-${type}`)\n    }\n\n    $log.innerHTML = message\n\n    this.$output.appendChild($log)\n  }\n\n  submit (e) {\n    var inputValue = this.$input.value.trim()\n\n    // if input is blank, do nothing\n    if (inputValue === '') {\n      return e.preventDefault()\n    }\n\n    // add run to history\n    this.history.push(inputValue)\n    this.historyIndex = this.history.length\n\n    // log input value\n    this.log(inputValue, 'history')\n\n    // add return if it doesn't start with it\n    if (inputValue.indexOf('return') !== 0) {\n      inputValue = 'return ' + inputValue\n    }\n\n    // show output or errors\n    try {\n      // run the console input in the iframe context\n      var scriptOutput = this.getIframe().contentWindow.eval(`(function() {${inputValue}})()`)\n\n      this.log(scriptOutput)\n    } catch (err) {\n      this.log(err, 'error')\n    }\n\n    // clear the console value\n    this.$input.value = ''\n\n    // scroll console pane to bottom\n    // to keep the input into view\n    this.$container.scrollTop = this.$container.scrollHeight\n\n    e.preventDefault()\n  }\n\n  clear (e) {\n    if (e) e.preventDefault()\n    this.$output.innerHTML = ''\n  }\n\n  history (e) {\n    var UP = 38\n    var DOWN = 40\n    var gotHistory = false\n    var selectionStart = this.$input.selectionStart\n\n    // only if we have previous history\n    // and the cursor is at the start\n    if (e.keyCode === UP && this.historyIndex !== 0 && selectionStart === 0) {\n      this.historyIndex--\n      gotHistory = true\n    }\n\n    // only if we have future history\n    // and the cursor is at the end\n    if (e.keyCode === DOWN && this.historyIndex !== this.history.length - 1 && selectionStart === this.$input.value.length) {\n      this.historyIndex++\n      gotHistory = true\n    }\n\n    // only if history changed\n    if (gotHistory) {\n      this.$input.value = this.history[this.historyIndex]\n    }\n  }\n}\n","/* play plugin\n * adds a Run button\n */\n\nimport * as util from '../util.js'\n\nexport default class PluginPlay {\n  constructor (jotted, options) {\n    options = util.extend(options, {\n      firstRun: true,\n      buttonText: 'Run'\n    })\n\n    var priority = 10\n    // cached code\n    var cache = {}\n    // latest version of the code.\n    // replaces the cache when the run button is pressed.\n    var code = {}\n\n    // set firstRun=false to start with a blank preview.\n    // run the real content only after the first Run button press.\n    if (options.firstRun === false) {\n      cache = {\n        html: {\n          type: 'html',\n          content: ''\n        },\n        css: {\n          type: 'css',\n          content: ''\n        },\n        js: {\n          type: 'js',\n          content: ''\n        }\n      }\n    }\n\n    // run button\n    var $button = document.createElement('button')\n    $button.className = 'jotted-button jotted-button-play'\n    $button.innerHTML = options.buttonText\n\n    jotted.$container.appendChild($button)\n    $button.addEventListener('click', this.run.bind(this))\n\n    // capture the code on each change\n    jotted.on('change', this.change.bind(this), priority)\n\n    // public\n    this.cache = cache\n    this.code = code\n    this.jotted = jotted\n  }\n\n  change (params, callback) {\n    // always cache the latest code\n    this.code[params.type] = util.extend(params)\n\n    // replace the params with the latest cache\n    if (typeof this.cache[params.type] !== 'undefined') {\n      callback(null, this.cache[params.type])\n\n      // make sure we don't cache forceRender,\n      // and send it with each change.\n      this.cache[params.type].forceRender = null\n    } else {\n      // cache the first run\n      this.cache[params.type] = util.extend(params)\n\n      callback(null, params)\n    }\n  }\n\n  run (e) {\n    if (e) e.preventDefault()\n    // trigger change on each type with the latest code\n    for (let type in this.code) {\n      this.cache[type] = util.extend(this.code[type], {\n        // force rendering on each Run press\n        forceRender: true\n      })\n\n      // trigger the change\n      this.jotted.trigger('change', this.cache[type])\n    }\n  }\n}\n","/* pen plugin\n */\nexport default class PluginPen {\n  constructor (jotted, options) {\n    // available panes\n    let panes = {\n      html: { title: 'HTML', classChecker: 'jotted-has-html' },\n      css: { title: 'CSS', classChecker: 'jotted-has-css' },\n      js: { title: 'JavaScript', classChecker: 'jotted-has-js' },\n      console: { title: 'Console', classChecker: 'jotted-plugin-console' }\n    }\n\n    let $availablePanes = []\n    for (let p in panes) {\n      if (jotted.$container.classList.contains(panes[p].classChecker)) {\n        $availablePanes.push(jotted.$container.querySelector(`.jotted-pane-${p}`))\n      }\n    }\n\n    this.resizablePanes = []\n    for (let i = 0; i < $availablePanes.length; i++) {\n      let type\n\n      for (let j = 0; j < $availablePanes[i].classList.length; j++) {\n        if ($availablePanes[i].classList[j].indexOf('jotted-pane-') !== -1) {\n          type = $availablePanes[i].classList[j].replace('jotted-pane-', '')\n          break\n        }\n      }\n\n      if (!type) {\n        continue\n      }\n\n      let $pane = {\n        container: $availablePanes[i],\n        expander: undefined\n      }\n\n      this.resizablePanes.push($pane)\n\n      let $paneTitle = document.createElement('div')\n      $paneTitle.classList.add('jotted-pane-title')\n      $paneTitle.innerHTML = panes[type].title || type\n\n      let $paneElement = $availablePanes[i].firstElementChild\n      $paneElement.insertBefore($paneTitle, $paneElement.firstChild)\n\n      // insert expander element.\n      // only panes which have an expander can be shrunk or expanded\n      // first pane must not have a expander\n      if (i > 0) {\n        $pane.expander = document.createElement('div')\n        $pane.expander.classList.add('jotted-plugin-pen-expander')\n        $pane.expander.addEventListener('mousedown', this.startExpand.bind(this, jotted))\n\n        $paneElement.insertBefore($pane.expander, $paneTitle)\n      }\n    }\n  }\n\n  startExpand (jotted, event) {\n    let $pane = this.resizablePanes\n      .filter((pane) => { return pane.expander === event.target })\n      .shift()\n\n    let $previousPane = this.resizablePanes[this.resizablePanes.indexOf($pane) - 1]\n\n    let $relativePixel = 100 / parseInt(window.getComputedStyle($pane.container.parentNode)['width'], 10)\n\n    // ugly but reliable & cross-browser way of getting height/width as percentage.\n    $pane.container.parentNode.style.display = 'none'\n\n    $pane.startX = event.clientX\n    $pane.startWidth = parseFloat(window.getComputedStyle($pane.container)['width'], 10)\n    $previousPane.startWidth = parseFloat(window.getComputedStyle($previousPane.container)['width'], 10)\n\n    $pane.container.parentNode.style.display = ''\n\n    $pane.mousemove = this.doDrag.bind(this, $pane, $previousPane, $relativePixel)\n    $pane.mouseup = this.stopDrag.bind(this, $pane)\n\n    document.addEventListener('mousemove', $pane.mousemove, false)\n    document.addEventListener('mouseup', $pane.mouseup, false)\n  }\n\n  doDrag (pane, previousPane, relativePixel, event) {\n    // previous pane new width\n    let ppNewWidth = previousPane.startWidth + ((event.clientX - pane.startX) * relativePixel)\n\n    // current pane new width\n    let cpNewWidth = pane.startWidth - ((event.clientX - pane.startX) * relativePixel)\n\n    // contracting a pane is restricted to a min-size of 10% the container's space.\n    const PANE_MIN_SIZE = 10 // percentage %\n    if (ppNewWidth >= PANE_MIN_SIZE && cpNewWidth >= PANE_MIN_SIZE) {\n      pane.container.style.maxWidth = 'none'\n      previousPane.container.style.maxWidth = 'none'\n\n      previousPane.container.style.width = `${ppNewWidth}%`\n      pane.container.style.width = `${cpNewWidth}%`\n    }\n  }\n\n  stopDrag (pane, event) {\n    document.removeEventListener('mousemove', pane.mousemove, false)\n    document.removeEventListener('mouseup', pane.mouseup, false)\n  }\n}\n\n","/* bundle plugins\n */\n\n// register bundled plugins\nimport PluginRender from './plugins/render.js'\nimport PluginScriptless from './plugins/scriptless.js'\n\nimport PluginAce from './plugins/ace.js'\nimport PluginCodeMirror from './plugins/codemirror.js'\nimport PluginLess from './plugins/less.js'\nimport PluginCoffeeScript from './plugins/coffeescript.js'\nimport PluginStylus from './plugins/stylus.js'\nimport PluginBabel from './plugins/babel.js'\nimport PluginMarkdown from './plugins/markdown.js'\nimport PluginConsole from './plugins/console.js'\nimport PluginPlay from './plugins/play.js'\nimport PluginPen from './plugins/pen.js'\n\nexport default function BundlePlugins (jotted) {\n  jotted.plugin('render', PluginRender)\n  jotted.plugin('scriptless', PluginScriptless)\n\n  jotted.plugin('ace', PluginAce)\n  jotted.plugin('codemirror', PluginCodeMirror)\n  jotted.plugin('less', PluginLess)\n  jotted.plugin('coffeescript', PluginCoffeeScript)\n  jotted.plugin('stylus', PluginStylus)\n  jotted.plugin('babel', PluginBabel)\n  jotted.plugin('markdown', PluginMarkdown)\n  jotted.plugin('console', PluginConsole)\n  jotted.plugin('play', PluginPlay)\n  jotted.plugin('pen', PluginPen)\n}\n","/* jotted\n */\n\nimport * as util from './util.js'\nimport * as template from './template.js'\nimport * as plugin from './plugin.js'\nimport PubSoup from './pubsoup.js'\n\nclass Jotted {\n  constructor (container, opts) {\n    if (!container) {\n      throw new Error('Can\\'t find Jotted container.')\n    }\n\n    const $jottedContainer = document.createElement('div')\n    container.appendChild($jottedContainer)\n\n    // private data\n    var _private = {}\n    this._get = function (key) {\n      return _private[key]\n    }\n    this._set = function (key, value) {\n      _private[key] = value\n      return _private[key]\n    }\n\n    // options\n    var options = this._set('options', {\n      files: [],\n      showBlank: false,\n      runScripts: true,\n      pane: 'result',\n      debounce: 250,\n      plugins: [],\n      ...opts\n    })\n\n    // the render plugin is mandatory\n    if (options.plugins.indexOf('render') === -1) {\n      options.plugins = options.plugins.concat('render')\n    }\n\n    // use the scriptless plugin if runScripts is false\n    if (options.runScripts === false) {\n      options.plugins.push('scriptless')\n    }\n\n    // cached content for the change method.\n    this._set('cachedContent', {\n      html: null,\n      css: null,\n      js: null\n    })\n\n    // PubSoup\n    var pubsoup = this._set('pubsoup', new PubSoup())\n\n    this._set('trigger', this.trigger())\n    this._set('on', function () {\n      pubsoup.subscribe.apply(pubsoup, arguments)\n    })\n    this._set('once', function () {\n      pubsoup.subscribeOnce.apply(pubsoup, arguments)\n    })\n    this._set('off', function () {\n      pubsoup.unsubscribe.apply(pubsoup, arguments)\n    })\n    var done = this._set('done', function () {\n      pubsoup.done.apply(pubsoup, arguments)\n    })\n\n    // after all plugins run\n    // show errors\n    done('change', this.errors.bind(this))\n\n    // DOM\n    var $container = this._set('$container', $jottedContainer)\n    $container.innerHTML = template.container()\n    util.addClass($container, template.containerClass())\n\n    // default pane\n    var paneActive = this._set('paneActive', options.pane)\n    util.addClass($container, template.paneActiveClass(paneActive))\n\n    // status nodes\n    this._set('$status', {})\n\n    for (let type of [ 'html', 'css', 'js' ]) {\n      this.markup(type)\n    }\n\n    // textarea change events.\n    $container.addEventListener('keyup', util.debounce(this.change.bind(this), options.debounce))\n    $container.addEventListener('change', util.debounce(this.change.bind(this), options.debounce))\n\n    // pane change\n    $container.addEventListener('click', this.pane.bind(this))\n\n    // expose public properties\n    this.$container = this._get('$container')\n    this.on = this._get('on')\n    this.once = this._get('once')\n    this.off = this._get('off')\n    this.done = this._get('done')\n    this.trigger = this._get('trigger')\n    this.paneActive = this._get('paneActive')\n\n    // init plugins\n    this.plugins = this._set('plugins', {})\n    plugin.init.call(this)\n\n    // load files\n    for (let type of [ 'html', 'css', 'js' ]) {\n      this.load(type)\n    }\n\n    // show all tabs, even if empty\n    if (options.showBlank) {\n      for (let type of [ 'html', 'css', 'js' ]) {\n        util.addClass($container, template.hasFileClass(type))\n      }\n    }\n\n    if (options.tabNames) {\n      this.renameTabs(options.tabNames)\n    }\n\n    // hide result tab\n    if (options.hideResultTab) {\n      util.addClass($container, template.hideResultClass())\n    }\n\n    var priority = 5\n    this.on('change', (params, callback) => {\n      this._get('cachedContent')[params.type] = params.content\n\n      callback(null, params)\n    }, priority)\n  }\n\n  destroy () {\n    for (let name in this.plugins) {\n      const plugin = this.plugins[name]\n\n      if (typeof plugin.destroy === 'function') {\n        plugin.destroy()\n      }\n    }\n\n    this._get('pubsoup').unsubscribeAll()\n    this.$container.parentNode.removeChild(this.$container)\n  }\n\n  findFile (type) {\n    var file = {}\n    var options = this._get('options')\n\n    for (let fileIndex in options.files) {\n      let file = options.files[fileIndex]\n      if (file.type === type) {\n        return file\n      }\n    }\n\n    return file\n  }\n\n  markup (type) {\n    var $container = this._get('$container')\n    var $parent = $container.querySelector(`.jotted-pane-${type}`)\n    // create the markup for an editor\n    var file = this.findFile(type)\n\n    var $editor = document.createElement('div')\n    $editor.innerHTML = template.editorContent(type, file.url)\n    $editor.className = template.editorClass(type)\n\n    $parent.appendChild($editor)\n\n    // get the status node\n    this._get('$status')[type] = $parent.querySelector('.jotted-status')\n\n    // if we have a file for the current type\n    if (typeof file.url !== 'undefined' || typeof file.content !== 'undefined') {\n      // add the has-type class to the container\n      util.addClass($container, template.hasFileClass(type))\n    }\n  }\n\n  load (type) {\n    // create the markup for an editor\n    var file = this.findFile(type)\n    var $textarea = this._get('$container').querySelector(`.jotted-pane-${type} textarea`)\n\n    // file as string\n    if (typeof file.content !== 'undefined') {\n      this.setValue($textarea, file.content)\n    } else if (typeof file.url !== 'undefined') {\n      // show loading message\n      this.status('loading', [ template.statusLoading(file.url) ], {\n        type: type,\n        file: file\n      })\n\n      // file as url\n      util.fetch(file.url, (err, res) => {\n        if (err) {\n          // show load errors\n          this.status('error', [ template.statusFetchError(err) ], {\n            type: type\n          })\n\n          return\n        }\n\n        // clear the loading status\n        this.clearStatus('loading', {\n          type: type\n        })\n\n        this.setValue($textarea, res)\n      })\n    } else {\n      // trigger a change event on blank editors,\n      // for editor plugins to catch.\n      // (eg. the codemirror and ace plugins attach the change event\n      // only after the initial change/load event)\n      this.setValue($textarea, '')\n    }\n  }\n\n  setValue ($textarea, val) {\n    $textarea.value = val\n\n    // trigger change event, for initial render\n    this.change({\n      target: $textarea\n    })\n  }\n\n  getValue (type) {\n    return this._get('cachedContent')[type]\n  }\n\n  updateValue (type, content) {\n    this._get('cachedContent')[type] = content\n    this.trigger('change', { type, content })\n  }\n\n  loadFiles (files = []) {\n    files.forEach(({ type, content }) => this.updateValue(type, content))\n  }\n\n  change (e) {\n    var type = util.data(e.target, 'jotted-type')\n    if (!type) {\n      return\n    }\n\n    // don't trigger change if the content hasn't changed.\n    // eg. when blurring the textarea.\n    var cachedContent = this._get('cachedContent')\n    if (cachedContent[type] === e.target.value) {\n      return\n    }\n\n    // cache latest content\n    cachedContent[type] = e.target.value\n\n    // trigger the change event\n    this.trigger('change', {\n      type: type,\n      file: util.data(e.target, 'jotted-file'),\n      content: cachedContent[type]\n    })\n  }\n\n  errors (errs, params) {\n    this.status('error', errs, params)\n  }\n\n  pane (e) {\n    if (!util.data(e.target, 'jotted-type')) {\n      return\n    }\n\n    var $container = this._get('$container')\n    var paneActive = this._get('paneActive')\n    util.removeClass($container, template.paneActiveClass(paneActive))\n\n    paneActive = this._set('paneActive', util.data(e.target, 'jotted-type'))\n    util.addClass($container, template.paneActiveClass(paneActive))\n\n    e.preventDefault()\n  }\n\n  status (statusType = 'error', messages = [], params = {}) {\n    if (!messages.length) {\n      return this.clearStatus(statusType, params)\n    }\n\n    var $status = this._get('$status')\n\n    // add error/loading class to status\n    util.addClass($status[params.type], template.statusClass(statusType))\n\n    util.addClass(this._get('$container'), template.statusActiveClass(params.type))\n\n    var markup = ''\n    messages.forEach(function (err) {\n      markup += template.statusMessage(err)\n    })\n\n    $status[params.type].innerHTML = markup\n  }\n\n  clearStatus (statusType, params) {\n    var $status = this._get('$status')\n\n    util.removeClass($status[params.type], template.statusClass(statusType))\n    util.removeClass(this._get('$container'), template.statusActiveClass(params.type))\n    $status[params.type].innerHTML = ''\n  }\n\n  // debounced trigger method\n  // custom debouncer to use a different timer per type\n  trigger () {\n    var options = this._get('options')\n    var pubsoup = this._get('pubsoup')\n\n    // allow disabling the trigger debouncer.\n    // mostly for testing: when trigger events happen rapidly\n    // multiple events of the same type would be caught once.\n    if (options.debounce === false) {\n      return function () {\n        pubsoup.publish.apply(pubsoup, arguments)\n      }\n    }\n\n    // cooldown timer\n    var cooldown = {}\n    // multiple calls\n    var multiple = {}\n\n    return function (topic, { type = 'default' } = {}) {\n      if (cooldown[type]) {\n        // if we had multiple calls before the cooldown\n        multiple[type] = true\n      } else {\n        // trigger immediately once cooldown is over\n        pubsoup.publish.apply(pubsoup, arguments)\n      }\n\n      clearTimeout(cooldown[type])\n\n      // set cooldown timer\n      cooldown[type] = setTimeout(() => {\n        // if we had multiple calls before the cooldown,\n        // trigger the function again at the end.\n        if (multiple[type]) {\n          pubsoup.publish.apply(pubsoup, arguments)\n        }\n\n        multiple[type] = null\n        cooldown[type] = null\n      }, options.debounce)\n    }\n  }\n\n  renameTabs (map) {\n    const nav = this.$container.querySelector('.jotted-nav')\n\n    Object.keys(map).forEach(key => {\n      (nav.querySelector(`a[data-jotted-type=\"${key}\"`) || {}).innerHTML = map[key]\n    })\n  }\n}\n\n// register plugins\nJotted.plugin = function () {\n  return plugin.register.apply(this, arguments)\n}\n\n// register bundled plugins\nimport BundlePlugins from './bundle-plugins.js'\nBundlePlugins(Jotted)\n\nexport default Jotted\n"],"names":["extend","obj","defaults","extended","Object","keys","forEach","key","fetch","url","callback","xhr","window","XMLHttpRequest","open","responseType","onload","status","responseText","onerror","err","send","runCallback","index","params","arr","errors","res","push","length","seqRunner","apply","arguments","seq","debounce","fn","delay","cooldown","multiple","clearTimeout","setTimeout","hasClass","node","className","tempClass","indexOf","addClass","removeClass","spaceBefore","spaceAfter","replace","data","attr","getAttribute","defaultModemap","getMode","type","file","customModemap","modemap","keyLength","slice","container","paneActiveClass","containerClass","hasFileClass","hideResultClass","editorClass","editorContent","fileUrl","statusMessage","statusClass","statusActiveClass","pluginClass","name","statusLoading","statusFetchError","plugins","find","id","pluginIndex","plugin","_id","Error","register","init","_get","Plugin","pluginName","pluginOptions","options","util","template","PubSoup","topics","callbacks","query","topic","subscriber","priority","foundTopic","_priority","sort","a","b","pack","unsubscribe","subscribe","call","splice","remover","runList","runCallbacks","c","PluginRender","jotted","supportSrcdoc","document","createElement","$resultFrame","$container","querySelector","frameContent","content","html","css","js","onMessage","domready","e","lastCallback","addEventListener","on","change","bind","removeEventListener","style","body","script","oldFrameContent","forceRender","$newResultFrame","parentNode","replaceChild","contentWindow","write","close","setAttribute","jsUrl","location","trigger","source","JSON","parse","PluginScriptless","runScriptTypes","fragment","innerHTML","typeAttr","$scripts","querySelectorAll","i","removeChild","PluginAce","editor","ace","$editors","$textarea","$aceContainer","appendChild","edit","editorOptions","getSession","setMode","setOptions","$blockScrolling","Infinity","aceEditor","setValue","editorChange","getValue","PluginCodeMirror","lineNumbers","CodeMirror","fromTextArea","setOption","cmEditor","PluginLess","less","isLess","render","PluginCoffeeScript","CoffeeScript","isCoffee","compile","PluginStylus","stylus","isStylus","PluginBabel","Babel","babel","transform","code","PluginMarkdown","marked","PluginConsole","tabName","autoClear","clearText","aliases","join","history","historyIndex","logCaptureSnippet","capture","toString","contentCache","$nav","$pane","$output","$input","$inputForm","$clear","submit","clear","onChange","done","lastPool","pool","$jottedContainer","getIframe","getMessage","log","message","snippetlessContent","console","oldConsoleLog","Function","prototype","parent","postMessage","stringify","$log","inputValue","value","trim","preventDefault","scriptOutput","eval","scrollTop","scrollHeight","UP","DOWN","gotHistory","selectionStart","keyCode","PluginPlay","firstRun","buttonText","cache","$button","run","PluginPen","panes","title","classChecker","$availablePanes","p","classList","contains","resizablePanes","j","expander","undefined","$paneTitle","add","$paneElement","firstElementChild","insertBefore","firstChild","startExpand","event","filter","pane","target","shift","$previousPane","$relativePixel","parseInt","getComputedStyle","display","startX","clientX","startWidth","parseFloat","mousemove","doDrag","mouseup","stopDrag","previousPane","relativePixel","ppNewWidth","cpNewWidth","PANE_MIN_SIZE","maxWidth","width","BundlePlugins","Jotted","opts","_private","_set","files","showBlank","runScripts","concat","pubsoup","subscribeOnce","paneActive","markup","once","off","load","tabNames","renameTabs","hideResultTab","destroy","unsubscribeAll","fileIndex","$parent","findFile","$editor","clearStatus","val","updateValue","cachedContent","errs","statusType","messages","$status","publish","map","nav"],"mappings":"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"}